# 2022长安杯wp

案件背景某地警方接到受害人报案称其在某虚拟币交易网站遭遇诈骗，该网站号称使用”USTD币“购买所谓的"HT币”，受害人充值后不但“HT币”无法提现、交易，而且手机还被恶意软件锁定勒索。警方根据受害人提供的虚拟币交易网站调取了对应的服务器镜像并对案件展开侦查。
>VC容器密码为：2022.4th.changancup!
>链接： https://pan.baidu.com/s/1f9xzt0jooZ-RZylwtt3YvQ
提取码： 1234
SHA256:37263f0aace3e33e7f303473e85e69ef804eb16a2500b68a
6b90c895784666f5

![输入图片说明](/imgs/2022-11-06/C8oBegwhiVdnCBzm.png)



## 检材一：1-10
根据报案人提供的网站域名和IP，警方调取了对应的服务器镜像“检材1”，分析掌握的检材回答下列问题
>1	检材1的SHA256值为
2	分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2
3	检材1中，操作系统发行版本号为
4	检材1系统中，网卡绑定的静态IP地址为
5	检材1中，网站jar包所存放的目录是
6	检材1中，监听7000端口的进程对应文件名为
7	检材1中，网站管理后台页面对应的网络端口为
8	检材1中，网站前台页面里给出的APK的下载地址是
9	检材1中，网站管理后台页面调用的用户表(admin)里的密码字段加密方式为?
10	分析检材1，网站管理后台登录密码加密算法中所使用的盐值是


>1	检材1的SHA256值为
>因为是赛后复盘，弘连的软件过期了，用的是美亚的取证大师进行操作。挂载完以后，右键即算哈希，得到结果
>**9E48BB2CAE5C1D93BAF572E3646D2ECD26080B70413DC7DC4131F88289F49E34**
>![输入图片说明](/imgs/2022-11-06/E91mmidFXUwIQonu.png)

>2	分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2
>用仿真软件仿真检材一，通过last命令查看
>得到答案**172.16.80.100**
>![输入图片说明](/imgs/2022-11-09/8Q5M64f9rygpp4DF.png)

>3	检材1中，操作系统发行版本号为
>在火眼创建虚拟机的时候可以看到**7.5.1804**
>![输入图片说明](/imgs/2022-11-09/kXS2RcZWKMmVuIcK.png)


>4	检材1系统中，网卡绑定的静态IP地址为
>找配置文件/etc/sysconfig/network-scripts/ifcfg-en33
>**172.16.80.133**![输入图片说明](/imgs/2022-11-09/nhcYuzy9eZkW3EmB.png)
>

>5	检材1中，网站jar包所存放的目录是
>直接history一下，因为该虚拟机不支持鼠标滚轮滑动，所以在history后面价格管道符再加上more，就可以支持回车查看了命令：history | more
>很明显，在**/web/app**下
>![输入图片说明](/imgs/2022-11-09/w3KVihNtWcBOBDsK.png)

后面的就需要启动服务器进行检查了，不会搭建服务器的同学也不要担心，九百多行命令大致看一下，只需要学会怎么启动就可以了。
在第953行有一个 sh start_web.sh的脚本启动，但是后面可以看到有个人吧这个脚本删掉了，所以只能手动启动。（这其实是一个坑，这个启动文件会在后面的检材里发现）
>6	检材1中，监听7000端口的进程对应文件名为
>注意.jar后缀的包都是后端代码，.js是前端代码，所以过滤一下历史命令，发现166-171是所有jar包的启动路径和方式，两种思路

>![输入图片说明](/imgs/2022-11-09/j2CjpoGg00qfHvg4.png)
>>第一种：挨个启动启动后观看7000端口（其实启动时候仔细看已经有答案了）![输入图片说明](/imgs/2022-11-09/mJxfj0DsqMnS5Pbl.png)
>>第二种：文件导出来看源码，导出来以后不能直接打开，需要有反编译软件如
>![输入图片说明](/imgs/2022-11-09/EvOmVRVvn0vdFFHk.png)
>然后把文件拖进去然后看源码就会发现答案
>![输入图片说明](/imgs/2022-11-09/YmfSJz86SG5hmc3v.png)


7,8题建议从检材二里面找到启动脚本然后在做，不然看历史命令太太太麻烦了。9,10为源码分析，把admin-api.jar包导出来看源码。

7	检材1中，网站管理后台页面对应的网络端口为
8	检材1中，网站前台页面里给出的APK的下载地址是
>9	检材1中，网站管理后台页面调用的用户表(admin)里的密码字段加密方式为?
10	分析检材1，网站管理后台登录密码加密算法中所使用的盐值是
>随意一看源码9题答案是**MD5**
>10题是**XehGyeyrVgOV4P8Uf70REVpIw3iVNwNs**
>![输入图片说明](/imgs/2022-11-09/V11n33a12JOO59qR.png)
>仔细一看这个java包里面给的信息真不少
>这里有一个数据库的密码账号，还有一个IP是128，猜测是数据库服务器![输入图片说明](/imgs/2022-11-09/cbgvecwI985d6aCh.png)
>这里还有mongodb和redis数据库![输入图片说明](/imgs/2022-11-09/e4aLmZ5k7I9tQv2Q.png)

## 检材二：11-19
>11	检材2中，windows账户Web King的登录密码是
>仿真一下**135790**
>![输入图片说明](/imgs/2022-11-09/rNZaXeEM8RDK5J0E.png)

>12	检材2中，除检材1以外，还远程连接过哪个IP地址？并用该地址解压检材3
>里面有链接172.16.80.128的记录
>![输入图片说明](/imgs/2022-11-09/e3dnqhuQuGAqzVsw.png)

>13	检材2中，powershell中输入的最后一条命令是
>当时比赛时候找了好久，还尝试了在虚拟机里面调用命令，但是没搞出来，命令文件在下图路径中文件里，所以答案是**ipconfig**
>其实仿真出来直接摁键盘上上下左右的上键历史记录就出来了，当时还真没想到
>![输入图片说明](/imgs/2022-11-09/C05oSQy2kOOw1M6N.png)
![输入图片说明](/imgs/2022-11-09/o5EkRxP8KOmS2TXD.png)



>14	检材2中，下载的涉案网站源代码文件名为
>在压缩文件里翻找一下（还好不多），找一下可疑的文件然后导出来看一下，或者到浏览器下载记录里面看。
>![输入图片说明](/imgs/2022-11-09/EJiWDPupZyjA76YU.png)
>![输入图片说明](/imgs/2022-11-09/vzGKOv9ttJn8v5bC.png)
>这个jar的五个文件就是检材一网站搭建里面的jar包
>答案为：**ZTuoExchange_framework-master.zip**

15	检材2中，网站管理后台root账号的密码为
16	检材2中，技术员使用的WSL子系统发行版本是
17	检材2中，运行的数据库服务版本号是
18	上述数据库debian-sys-maint用户的初始密码是
19	检材3服务器root账号的密码是

<!--stackedit_data:
eyJoaXN0b3J5IjpbMjE0MzIxMDU5NywtNzI4MDU4NTAxLDE1Mz
IzMzA1MjMsMTI3ODA2MDg0Myw4NzMyNzQxNTYsLTI0MTA0NDEw
OCwxNDg3NjMyNjY5LC05ODQyMjU3ODEsMjEzMDk3ODg3MSwtOD
c1MjEzNzgxLC0xOTk4MTI4NjI2LDE3NzIyNTc0MjksLTEzNjA2
MDkwODQsLTQyOTA4ODk3M119
-->